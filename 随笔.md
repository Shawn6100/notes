# 随笔

> 想到什么记什么



## Flask

### 快速上手

> app.py

```python
from flask import Flask

app = Flask(__name__)

@app.route("/")
def hello_world():
    return "<p>Hello, World!</p>"

if __name__ == '__main__':
    app.run()
```

1. 首先我们导入了 Flask 类。该类的实例将会成为我们的 WSGI 应用。
2. 接着我们创建一个该类的实例。第一个参数是应用模块或者包的名称。 `__name__` 是一个适用于大多数情况的快捷方式。有了这个参数， Flask 才能知道在哪里可以找到模板和静态文件等东西。
3. 然后我们使用 `route()` 装饰器来告诉 Flask 触发函数的 URL 。
4. 函数返回需要在用户浏览器中显示的信息。默认的内容类型是 HTML ，因此字符串中的 HTML 会被浏览器渲染。



### 路由

使用 `route()` 装饰器来把函数绑定到 URL

```python
@app.route('/')
def index():
    return 'Index Page'

@app.route('/hello')
def hello():
    return 'Hello, World'
```



### 变量规则

通过把 URL 的一部分标记为 `<variable_name>` 就可以在 URL 中添加变量。标记的 部分会作为关键字参数传递给函数。通过使用 `<converter:variable_name>` ，可以 选择性的加上一个转换器，为变量指定规则。

```python
from markupsafe import escape

@app.route('/user/<username>')
def show_user_profile(username):
    # show the user profile for that user
    return f'User {escape(username)}'

@app.route('/post/<int:post_id>')
def show_post(post_id):
    # show the post with the given id, the id is an integer
    return f'Post {post_id}'

@app.route('/path/<path:subpath>')
def show_subpath(subpath):
    # show the subpath after /path/
    return f'Subpath {escape(subpath)}'
```

**转换器类型**

| `string` | （缺省值） 接受任何不包含斜杠的文本 |
| :------: | :---------------------------------: |
|  `int`   |             接受正整数              |
| `float`  |            接受正浮点数             |
|  `path`  |   类似 `string` ，但可以包含斜杠    |
|  `uuid`  |          接受 UUID 字符串           |



### 唯一的URL / 重定向行为

以下两条规则的不同之处在于是否使用尾部的斜杠。

```python
@app.route('/projects/')
def projects():
    return 'The project page'

@app.route('/about')
def about():
    return 'The about page'
```

`projects` 的 URL 是中规中矩的，尾部有一个斜杠，看起来就如同一个文件 夹。访问一个没有斜杠结尾的 URL （ `/projects` ）时 Flask 会自动进行重 定向，帮您在尾部加上一个斜杠（ `/projects/` ）。

`about` 的 URL 没有尾部斜杠，因此其行为表现与一个文件类似。如果访问这 个 URL 时添加了尾部斜杠（`` /about/ `` ）就会得到一个 404 “未找到” 错 误。这样可以保持 URL 唯一，并有助于搜索引擎重复索引同一页面。



### URL构建

`url_for()` 函数用于构建指定函数的 URL。它把**函数名称**作为**第一个参数**。它可以接受**任意个**关键字参数，每个关键字参数对应 URL 中的变量。未知变量将添加到 URL 中作为查询参数。

为什么不在把 URL 写死在模板中，而要使用反转函数 `url_for()` 动态构建？

1. 反转通常比硬编码 URL 的描述性更好。
2. 您可以只在一个地方改变 URL ，而不用到处乱找。
3. URL 创建会为您处理特殊字符的转义，比较直观。
4. 生产的路径总是绝对路径，可以避免相对路径产生副作用。
5. 如果您的应用是放在 URL 根路径之外的地方（如在 `/myapplication` 中，不在 `/` 中）， `url_for()` 会为您妥善处理。

```python
from flask import url_for

app = Flask(__name__)

@app.route('/')
def index():
    return 'index'

@app.route('/login')
def login():
    return 'login'

@app.route('/user/<username>')
def profile(username):
    return f'{username}\'s profile'

with app.test_request_context():
    print(url_for('index'))
    print(url_for('login'))
    print(url_for('login', next='/'))
    print(url_for('profile', username='John Doe'))
```



### HTTP方法

Web 应用使用不同的 HTTP 方法处理 URL 。当使用 Flask 时，应当熟悉 HTTP 方法。 缺省情况下，一个路由只回应 `GET` 请求。 可以使用 `route()` 装饰器的 `methods` 参数来处理不同的 HTTP 方法

```python
from flask import Flask
from flask import request

app = Flask(__name__)


def do_the_login():
    return "Login...."


def show_the_login_form():
    return "<form action="">" \
           "username: <input type='text' name='username' /><br />" \
           "password: <input type='password' name='password' />" \
           "</form>"


@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        return do_the_login()
    else:
        return show_the_login_form()

if __name__ == '__main__':
    app.run()
```



### 静态文件

动态的 web 应用也需要静态文件，一般是 CSS 和 JavaScript 文件。理想情况下服务器已经配置好了提供静态文件的服务。但是在开发过程中， Flask 也能做好这项工作。只要在包或模块旁边创建一个名为 `static` 的文件夹就行了。 静态文件位于应用的 `/static` 中。

使用特定的 `'static'` 端点就可以生成相应的 URL

```python
url_for('static', filename='style.css')
```

这个静态文件在文件系统中的位置应该是 `static/style.css` 



### 渲染模板

在 Python 内部生成 HTML 不好玩，且相当笨拙。因为您必须自己负责 HTML 转义， 以确保应用的安全。因此， Flask 自动为您配置 `Jinja2` 模板引擎。

使用 `render_template()` 方法可以渲染模板，您只要提供模板名称和需要 作为参数传递给模板的变量就行了

```python
from flask import render_template

@app.route('/hello/')
@app.route('/hello/<name>')
def hello(name=None):
    return render_template('hello.html', name=name)
```

Flask 会在 `templates` 文件夹内寻找模板。



### JSON

Flask 接收前端传入的Json参数

```python
import flask
from flask import request, json, jsonify

@app.route('/')
def main():
    # 接收参数
    data = request.get_data()
    data = json.loads(data)
    
    # 获取参数
    article_A = data['article_A']
    article_B = data['article_B']
    
    # 返回 Json 格式数据
    return jsonify({
        "code": 200,
        "msg": "success"
    })
```





## WEB

### 去除a标签下划线和颜色

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <title>去除a标签下划线和颜色</title>
    <style>
        a {
            text-decoration: none;
            color: #000;
        }
    </style>
</head>
<body>
    <button><a href="https://www.baidu.com">百度</a></button>
</body>
</html>
```





## SpringBoot

### 实现文件上传下载

```java
// 强制浏览器下载
response.setHeader("content-disposition", "attachment;filename=" + realName);

// 浏览器尝试打开
response.setHeader("content-disposition", "inline;filename=" + realName);
```

